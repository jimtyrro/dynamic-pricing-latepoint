"use strict";class TechXelaLatePointCoreAdmin{constructor(){this.ready()}ready(){jQuery(document).ready((()=>{this.initSideMenu(),this.initLateSelects(),this.initWpEditorTextareas(),this.initTabs(),this.initAddonsInfo(),this.initFormBlocksContainer(),this.initFormBlockConditions(),this.initExternalLinks()}))}initFormBlocksContainer(){let t=jQuery(".tx-form-blocks-w");t.on("change","select.form-block-condition-select",(t=>{let e=jQuery(t.currentTarget),o=e.closest(".form-block-condition"),i=o.closest(".form-block-conditions");o.find(".form-block-condition-select").attr("disabled","disabled"),o.find(".form-block-condition-value-w").hide(),o.addClass("os-loading");let n={target:o.find(".form-block-condition-target").val(),target_prop:o.find(".form-block-condition-target-prop").val(),comparison:o.find(".form-block-condition-comparison").val(),form_block_id:e.closest(".os-form-block").data("os-form-block-id"),condition_id:o.data("condition-id")},a={action:latepoint_helper.route_action,route_name:i.data("tx-condition-refresh-route"),params:n,return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:t=>{if(t.status===latepoint_helper.response_status.success){e.data("refresh-segments").split(",").forEach((e=>{o.find(`.form-block-condition-${e}-w`).replaceWith(t.message[e])})),this.initFormBlockConditions()}else latepoint_add_notification(latepoint_helper.techxela_laf_form_block_condition_refresh_error,"error");o.find(".form-block-condition-select").removeAttr("disabled"),o.removeClass("os-loading")}})})),t.on("click",".form-block-remove-condition",(t=>(jQuery(t.currentTarget).closest(".form-block-conditions").find(".form-block-condition").length>1?jQuery(t.currentTarget).closest(".form-block-condition").remove():latepoint_add_notification(latepoint_helper.techxela_laf_form_block_condition_deletion_warning,"error"),!1))),t.on("change",".form-block-scheduling-toggle .os-form-toggler-group input",(t=>{let e=jQuery(t.currentTarget),o=e.closest(".os-form-block").find(".form-block-recurring-section");"on"===e.val()?o.show():o.hide()}))}initNewFormBlock(t,e){this.initFormBlockConditions(),t.trigger("initNewTxFormBlock")}initFormBlockConditions(){latepoint_init_input_masks(),this.initLateSelects()}addFormBlockCondition(t,e){t.closest(".form-block-condition").after(e.message),this.initFormBlockConditions()}formBlockRemoved(t){t.closest(".os-form-block").remove()}initTabs(){jQuery(".tx-latepoint-tab-triggers").on("click",".tx-latepoint-tab-trigger",(function(){let t=jQuery(this).closest(".tx-latepoint-tabs-w");return t.find(".tx-latepoint-tab-trigger.active").removeClass("active"),t.find(".tx-latepoint-tab-content").removeClass("active"),jQuery(this).addClass("active"),t.find(".tx-latepoint-tab-content"+jQuery(this).data("tab-target")).addClass("active"),jQuery(".tx-latepoint-tab-triggers").trigger("trigger:pulled",this),!1}))}initAddonsInfo(){jQuery(".addons-info-holder").on("click",".tx-addon-action-btn",(function(t){t.preventDefault();let e=jQuery(this);e.addClass("os-loading");let o={addon_name:e.data("addon-name"),addon_path:e.data("addon-path"),addon_title:e.data("addon-title"),addon_pid:e.data("addon-pid")},i={action:"latepoint_route_call",route_name:e.data("route-name"),params:o,layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:i,success:t=>{e.removeClass("os-loading"),"success"===t.status?(latepoint_add_notification(t.message),latepoint_load_addons_info()):"404"===t.code?latepoint_show_data_in_lightbox(t.message):latepoint_add_notification(t.message,"error")}})}))}maybeReturnToRoute(t){let e=t.closest(".os-form-w").find('input[name="txLpReturnTo"]');e.length>0&&e.val().length>0&&(window.location=atob(e.val()))}initDatePickerForm(){latepoint_init_custom_day_schedule(),jQuery(".date-picker-form-w").on("click",".tx-date-picker-save-btn",(t=>{t.preventDefault();let e=jQuery(t.target).closest(".date-picker-form-w"),o=e.find('input[name="input_field_id"]').val(),i=jQuery(`#${o}`),n=i.closest(".tx-date-group").find(".tx-date-field-edit-btn"),a=new URLSearchParams(decodeURIComponent(n.data("os-params")));const r=e.find('input[name="date"]').val(),l=this.formatDate(r);a.set("date",l),a.set("format",latepoint_helper.date_format),a.set("input_field_id",o);const s=a.toString();i.attr("value",l).val(l),n.attr("data-os-params",s).data("os-params",s),latepoint_lightbox_close()}))}formatDate(t){let e=new Date(t).toISOString().slice(0,10).split("-"),o=e[0],i=e[1],n=e[2];return latepoint_helper.date_format.replace("Y",o).replace("m",i).replace("d",n)}maskPercent(t,e=4){jQuery().inputmask&&t.inputmask({alias:"decimal",radixPoint:latepoint_helper.decimal_separator,digits:e,digitsOptional:!1,suffix:"%",placeholder:"0.00",rightAlign:!1})}initSideMenu(){jQuery(".latepoint-side-menu-w ul.side-menu > li > a").on("click",(function(t){let e=jQuery(t.currentTarget),o=e.find("i");o.length&&o.hasClass("techxela-latepoint-icons")&&(o.hasClass("target-blank")&&(t.preventDefault(),t.stopPropagation(),window.open(e.attr("href"),"_blank")),e.trigger("txLPSideMenuItem:clicked")),e.trigger("latepoint:sideMenuItem:clicked")}))}initLateSelects(){jQuery(".os-late-select").lateSelect()}initWpEditorTextareas(){jQuery("textarea.tx-wp-editor-textarea").each((function(t,e){latepoint_init_tiny_mce(jQuery(this).attr("id"))}))}initExternalLinks(){jQuery(".tx-external-link, a.step-message").on("click",(function(t){t.preventDefault(),t.stopPropagation();let e=jQuery(t.currentTarget);window.open(e.attr("href"),e.attr("target"))}))}clearAdminNotifs(){jQuery(".os-notifications").remove()}randNum(t){const e=new Uint32Array(t);self.crypto.getRandomValues(e);let o="";for(const t of e)o+=`${t}`;return o}resolveObjProp(t,e){return t.split(".").reduce((function(t,e){return t?t[e]:null}),e||self)}}window.techXelaLatePointCoreAdmin=new TechXelaLatePointCoreAdmin;
//# sourceMappingURL=core-admin.min.js.map